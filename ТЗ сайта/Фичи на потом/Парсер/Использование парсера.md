- Поиск запчастей по VIN-номеру автомобиля.
- Подгрузка цен для существующей карточки товара и его аналогов по артикулу.
- Поиск отсутствующих у нас запчастей напрямую по артикулу.
## Поиск запчастей по VIN-номеру автомобиля
Через поиск ввёл VIN-номер автомобиля -> Высветились 2 таба: Группированный список и Схемы узлов для данного авто. Изначально находимся на табе Схемы узлов.
**Моторное масло по VIN мы никогда не должны подгружать. Это не запчасти, это другое. Его просто выкидываем при парсинге.**
### Схема узлов
При нажатии на какую-то из схем:
**Запчасти есть**:
Высвечиваются кликабельные части и их артикулы. Ниже примерное отображение:
- При нажатии на номер - подсветка соответствующей строки запчасти, и наоборот - при нажатии на строку - подсветка прямоугольника с номером запчасти на схеме
- (множественное выделение, как у Росско не нужно. Пусть будет одинарное)
![](_attachments/Покупка%20запчасти%20по%20VIN.%20UH-20241010153649036.webp)
При нажатии на "цены и аналоги" выдвигается дровер справа, где цены на оригинал, а ниже - на аналоги:
- Посмотреть картинку можно на Яндекс Картинках
- Отображение Бренда, Артикула, Наименование, Сроков доставки, Остатков, Цены, Количества для корзины. 
- К срокам доставки будем прибавлять день
- Возможность фильтровать по подгрузившимся фильтрам
![](_attachments/Покупка%20запчасти%20по%20VIN.%20UH-20241010151249750.webp)
При нажатии на номер запчасти подгрузка описания:
- зачёркнутое не нужно, картинка также не нужна, только возможность искать в Яндекс Картинках
![](_attachments/Покупка%20запчасти%20по%20VIN.%20UH-20241010152457629.webp)

**Запчастей нет**:
![](_attachments/UH.%20Покупка%20запчасти%20по%20VIN-20241009155838208.webp)
Ну нет и нет :)

### Группированный список
Подгружается дерево запчастей:
- Поиск внутри выгруженного дерева
- Раскрывающиеся списки без отображения чего-либо справа, отображаются только конечные пункты (сами запчасти)
Контент справа от дерева:
- Картинка схемы с возможностью перехода на саму схему
- Подгруженные артикулы и наименования. При нажатии на "цены и аналоги" такое же поведение, как и на странице со схемой
![](_attachments/Покупка%20запчасти%20по%20VIN.%20UH-20241010153837651.webp)

## Что будет со спаршенным товаром
(Здесь рассматривается ситуация, когда карточки товара с таким артикулом нет на сайте)
### Сырая карточка
После того, как покупатель положил товар в корзину, мы формируем "сырую карточку товара" на сайте:
- Вместо картинки - текст в прямоугольнике "Посмотреть на Яндекс Картинках" с соответствующим действием (при нажатии - переход на Яндекс Картинки и выполнение поискового запроса по артикулу+наименованию запчасти)
![](_attachments/Использование%20парсера-20241010162458820.webp)
- Наименование
- Артикул
- Кнопка "цены и аналоги" - для выдвижения дровера (при выдвижении дровера делается запрос на цены по артикулу товара).
- Товар не будет находиться в общей иерархии товаров, он будет лежать в какой-то куче, откуда его можно достать по артикулу (найти через верхний поиск). Ссылка на него без разницы какая - просто рандомная.

### Замена сырой карточки
Когда продавец закажет товар, пройдут определённые процессы, и товар появится в 1С, то оттуда он сможет выгрузить товар, предварительно, при необходимости, обновив скелет иерархии на сайте.
Когда новый товар выгружается из 1С, то мы проверяем, есть ли он в куче "сырых карточек", если есть, то "сырая карточка" становится упорядоченной (превращается в полноценную карточку товара) и встаёт в иерархию (т.к. в 1С принадлежит какой-то группе):
- Подгружает поля характеристик, прикреплённые к группе этой карточки товара (офк, они по дефолту незаполнены, ну ничего страшного, теперь у товароведа появляется возможность их заполнить)
- Формируется человекочитаемая ссылка на товар с учётом иерархии

### Удаление сырой карточки
В случае, если человек положил товар, для которого сформировалась "сырая карточка", и в течение суток не оплатил его:
- Товар удаляется из корзины
- Информация о "Сырой карточке" удаляется вместе со ссылкой на карточку

## Подгрузка цен существующих карточек
В упорядоченных по иерархии товарах (выгруженных из 1С) будут дроверы с ценами и аналогами у каждого товара.

## Поиск отсутствующих у нас запчастей напрямую по артикулу
Результат поиска таких запчастей - "сырая карточка товара"